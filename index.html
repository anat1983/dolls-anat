<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Travel Sync // Phygital Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Heebo:wght@300;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body>
    <div class="bg-grid"></div>
    <div class="scan-line"></div>
    <div id="flash"></div>
    
    <div id="sync-screen" class="hud-overlay">
        <div class="sync-box">
            <h1>בובות מקומיות</h1>
            <input type="text" id="user-name" placeholder="הכנס שם..." class="terminal-input">
            
            <div class="upload-area">
                <input type="file" id="doll-photo-input" accept="image/*" hidden>
                <button class="btn" onclick="document.getElementById('doll-photo-input').click()">צלם בובה (רקע ירוק מומלץ)</button>
                <p id="file-status">סטטוס: ממתין לסריקה...</p>
            </div>
            <button class="btn btn-pink" onclick="initializePortal()">להתחיל</button>
        </div>
    </div>
    
    <div id="main-interface" style="display: none;">
        <div class="hud-header">
            <h2 id="welcome-message">SYS_READY // </h2>
            <select id="destination" onchange="startTravel(this.value)">
                <option value="">-- בחר עיר --</option>
            </select>
        </div>
        <div id="map-viewport">
            <div id="map-zoom-container">
                <svg viewBox="0 0 300 850" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
                    <path class="israel-shape" d="M158,15 L182,30 L195,55 L202,85 L215,130 L228,180 L225,210 L210,235 L198,265 L195,300 L205,340 L210,385 L195,440 L180,490 L165,550 L150,620 L138,690 L130,760 L125,830 L110,830 L95,760 L85,690 L80,600 L88,520 L92,450 L82,390 L70,330 L65,270 L68,220 L82,185 L95,145 L102,105 L112,70 L122,40 L135,25 L150,18 Z" />
                </svg>
                <div id="markers-layer"></div>
                <div id="doll-container">
                    <img id="map-doll-img" src="" style="display:none;">
                </div>
            </div>
        </div>
    </div>
    
    <div id="travel-report" class="modal">
        <div class="modal-container">
            <div class="selfie-view">
                <img id="city-bg" src="">
                
                <div class="doll-overlay">
                    <img id="selfie-doll-img" src="">
                </div>
            </div>
            <div class="fact-card">
                <h2 id="city-name">שם העיר</h2>
                <hr style="border:1px solid var(--neon-cyan); margin:15px 0;">
                <p id="city-fact"></p>
                <button class="btn btn-pink" onclick="closeTravel()">חזור למפה</button>
                <button class="btn" onclick="showConfirmDialog()">אשר בחירה</button>
            </div>
        </div>
    </div>
    
    <!-- NEW: Confirmation Dialog -->
    <div id="confirm-dialog" class="modal">
        <div class="confirm-box">
            <h2>האם אתה בטוח?</h2>
            <p style="margin: 30px 0; font-size: 1.1rem;">זאת העיר שלי?</p>
            <div class="confirm-buttons">
                <button class="btn btn-pink" onclick="confirmCitySelection()">כן, זאת העיר שלי</button>
                <button class="btn" onclick="closeConfirmDialog()">לא</button>
            </div>
        </div>
    </div>

    <script src="cities.js"></script>
    <script src="script.js"></script>
</body>
</html>
