<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Travel Sync // Phygital Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Heebo:wght@300;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body>
    <div class="bg-grid"></div>
    <div class="scan-line"></div>
    <div id="flash"></div>
    
    <div id="sync-screen" class="hud-overlay">
        <div class="sync-box">
            <h1>בובות מקומיות</h1>
            <input type="text" id="user-name" placeholder="הכנס שם..." class="terminal-input">
            
            <div class="upload-area">
                <input type="file" id="doll-photo-input" accept="image/*" hidden>
                <button class="btn" onclick="document.getElementById('doll-photo-input').click()">צלם בובה (רקע ירוק מומלץ)</button>
                <p id="file-status">סטטוס: ממתין לסריקה...</p>
            </div>
            <button class="btn btn-pink" onclick="initializePortal()">להתחיל</button>
        </div>
    </div>
    
    <div id="main-interface" style="display: none;">
        <div class="hud-header">
            <h2 id="welcome-message">SYS_READY // </h2>
            <div class="control-panel">
                <select id="destination" onchange="startTravel(this.value)">
                    <option value="">-- בחר עיר --</option>
                </select>
            </div>
        </div>
        <div id="map-viewport">
            <div id="map-zoom-container">
                <svg viewBox="0 0 300 850" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
                    <path class="israel-shape" d="M155,10 L170,18 L188,30 L198,55 L202,85 L215,130 L228,185 L225,220 L210,245 L195,275 L195,315 L205,355 L210,405 L195,460 L180,510 L165,570 L145,650 L132,730 L125,840 L108,840 L95,765 L85,685 L82,605 L88,525 L94,455 L84,395 L70,335 L64,275 L68,225 L82,195 L95,155 L102,115 L112,80 L122,50 L135,35 L150,28 Z" />
                </svg>
                <div id="markers-layer"></div>
                <div id="doll-container">
                    <img id="map-doll-img" src="" style="display:none;">
                </div>
            </div>
        </div>
    </div>
    
    <div id="travel-report" class="modal">
        <div class="modal-container">
            <div class="selfie-view">
                <img id="city-bg" src="">
                
                <div class="doll-overlay">
                    <img id="selfie-doll-img" src="">
                </div>
            </div>
            <div class="fact-card">
                <h2 id="city-name">שם העיר</h2>
                <hr style="border:1px solid var(--neon-cyan); margin:15px 0;">
                <p id="city-fact"></p>
                <button class="btn btn-pink" onclick="closeTravel()">חזור למפה</button>
                <button class="btn" onclick="showConfirmDialog()">אשר בחירה</button>
            </div>
        </div>
    </div>
    
    <!-- NEW: Confirmation Dialog -->
    <div id="confirm-dialog" class="modal">
        <div class="confirm-box">
            <h2>האם אתה בטוח?</h2>
            <p style="margin: 30px 0; font-size: 1.1rem;">זאת העיר שלי?</p>
            <div class="confirm-buttons">
                <button class="btn btn-pink" onclick="confirmCitySelection()">כן, זאת העיר שלי</button>
                <button class="btn" onclick="closeConfirmDialog()">לא</button>
            </div>
        </div>
    </div>

    <script src="cities.js"></script>
    <script src="script.js"></script>
</body>
</html>
